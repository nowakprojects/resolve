<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Step-by-Step Tutorial · reSolve</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This document provides a step-by-step tutorial for the reSolve framework. Throughout this tutorial, you will iteratively develop a ShoppingList application and learn fundamental concepts of the reSolve framework."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Step-by-Step Tutorial · reSolve"/><meta property="og:type" content="website"/><meta property="og:url" content="https://reimagined.github.io/resolve/"/><meta property="og:description" content="This document provides a step-by-step tutorial for the reSolve framework. Throughout this tutorial, you will iteratively develop a ShoppingList application and learn fundamental concepts of the reSolve framework."/><meta property="og:image" content="https://reimagined.github.io/resolve/img/reSolve400x400-fill.png"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/resolve/undefined"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-118635726-3', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/resolve/js/scrollSpy.js"></script><link rel="stylesheet" href="/resolve/css/main.css"/><script src="/resolve/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/resolve/"><img class="logo" src="/resolve/img/resolve.svg" alt="reSolve"/><h2 class="headerTitleWithLogo">reSolve</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://medium.com/resolvejs" target="_self">Blog</a></li><li class="siteNavGroupActive"><a href="/resolve/docs/" target="_self">Docs</a></li><li class="siteNavGroupActive siteNavItemActive"><a href="/resolve/docs/tutorial" target="_self">Tutorial</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/reimagined/resolve" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Docs Index</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Docs Index</h3><ul class=""><li class="navListItem"><a class="navItem" href="/resolve/docs/">reSolve Documentation</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/introduction">Introduction</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/resolve/docs/tutorial">Step-by-Step Tutorial</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Basics</h4><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/write-side">Write Side</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/read-side">Read Side</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/sagas">Sagas</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/api-handlers">API Handlers</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/frontend">Frontend</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/manage-application">Manage a ReSolve Application</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/app-structure">reSolve App Structure</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/advanced-techniques">Advanced Techniques</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/authentication-and-authorization">Authentication and Authorization</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/preparing-to-production">Preparing to Production</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/testing">Testing</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/api-reference">API Reference</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/application-configuration">Application Configuration</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/contributing">Contributing</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">FAQ</h3><ul class=""><li class="navListItem"><a class="navItem" href="/resolve/docs/faq">FAQ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul class=""><li class="navListItem"><a class="navItem" href="/resolve/docs/troubleshooting">Troubleshooting</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Step-by-Step Tutorial</h1></header><article><div><span><p>This document provides a step-by-step tutorial for the reSolve framework.
Throughout this tutorial, you will iteratively develop a ShoppingList application and learn fundamental concepts of the reSolve framework.</p>
<p>We recommend that your familiarize yourself with basics of event sourcing and CQRS before you start this tutorial. You can find a curated list of resources in the <a href="/resolve/docs/faq">FAQ</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="table-of-contents"></a><a href="#table-of-contents" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2>
<ul>
<li><a href="#preparation---create-a-new-resolve-application">Preparation - Create a New reSolve Application</a></li>
<li><a href="#lesson-1---write-side---add-shopping-lists">Lesson 1 - Write side - Add Shopping Lists</a></li>
<li><a href="#lesson-2---read-side---create-a-read-model-to-query-shopping-lists">Lesson 2 - Read side - Create a Read Model to Query Shopping Lists</a></li>
<li><a href="#lesson-3---frontend---display-read-model-data-in-the-browser">Lesson 3 - Frontend - Display Read Model Data in the Browser</a></li>
<li><a href="#lesson-4---read-side---create-a-view-model-to-query-shopping-list-items">Lesson 4 - Read Side - Create a View Model to Query Shopping List Items</a></li>
<li><a href="#lesson-5---enable-editing">Lesson 5 - Enable Editing</a></li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="preparation---create-a-new-resolve-application"></a><a href="#preparation---create-a-new-resolve-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Preparation</strong> - Create a New reSolve Application</h2>
<p>Use the <strong>create-resolve-app</strong> tool to create a new reSolve application:</p>
<h5><a class="anchor" aria-hidden="true" id="npm"></a><a href="#npm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>npm:</h5>
<pre><code class="hljs css language-sh">$ npm i -g create-resolve-app
$ create-resolve-app shopping-list
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="npx"></a><a href="#npx" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>npx:</h5>
<pre><code class="hljs css language-sh">$ npx create-resolve-app shopping-list
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="yarn"></a><a href="#yarn" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yarn:</h5>
<pre><code class="hljs css language-sh">$ yarn create resolve-app shopping-list
</code></pre>
<p>After this, a minimal reSolve application is ready. To run it in development mode, type:</p>
<pre><code class="hljs css language-sh">$ <span class="hljs-built_in">cd</span> shopping-list
$ yarn run dev
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-1---write-side---add-shopping-lists"></a><a href="#lesson-1---write-side---add-shopping-lists" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 1</strong> - Write side - Add Shopping Lists</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-1">[Get the Code for This Lesson]</a></p>
<p>This lesson describes how to implement a write side for a reSolve application. An application's <a href="/resolve/docs/app-structure#write-and-read-sides">write side</a> handles commands, validates input data, and emits <strong>events</strong> based on valid commands. The framework then saves the emitted events to the <strong>event store</strong>.</p>
<h3><a class="anchor" aria-hidden="true" id="create-an-aggregate"></a><a href="#create-an-aggregate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create an Aggregate</h3>
<p>Define types of events that the write side can produce. Create an <strong>eventTypes.js</strong> file in the project's <strong>common</strong> folder and add the following content to it:</p>
<p><strong>common/eventTypes.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_LIST_CREATED = <span class="hljs-string">'SHOPPING_LIST_CREATED'</span> <span class="hljs-comment">// Indicates the creation of a shopping list</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_ITEM_CREATED = <span class="hljs-string">'SHOPPING_ITEM_CREATED'</span> <span class="hljs-comment">// Indicates the creation of an item within a shopping list</span>
</code></pre>
<p>Next, define an aggregate that handles commands and produces the defined events as a result. Create a <strong>shopping_list.commands.js</strong> file in the <strong>common/aggregates</strong> folder and add the following code to it:</p>
<p><strong>common/aggregates/shopping_list.commands.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED, SHOPPING_ITEM_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-comment">// This file exports an object that contains two command handlers.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// A command handler receives the aggregate state and a command payload.</span>
  <span class="hljs-comment">// A payload can contain arbitrary data related to the command.</span>
  <span class="hljs-comment">// For example, the "createShoppingList" command's payload contains the shopping list's name.</span>
  <span class="hljs-attr">createShoppingList</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_LIST_CREATED,
      <span class="hljs-attr">payload</span>: { name },
    }
  },
  <span class="hljs-comment">// The "createShoppingItem" command's payload contains an item's ID and display text.</span>
  <span class="hljs-attr">createShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_ITEM_CREATED,
      <span class="hljs-attr">payload</span>: { id, text },
    }
  },
}
</code></pre>
<p>A command handler returns an <strong>event</strong> object. This object should contain the following fields:</p>
<ul>
<li><strong>type</strong> - specifies the event's type;</li>
<li><strong>payload</strong> - specifies data associated with the event.</li>
</ul>
<p>The reSolve framework saves produced events to a persistent <strong><a href="/resolve/docs/write-side#event-store">event store</a></strong>. A newly created application is configured to use a SQLite event store. We suggest that you keep this configuration throughout the tutorial. For information on how to use other storage types, see the following documentation topics:</p>
<ul>
<li><a href="https://github.com/reimagined/resolve/blob/master/docs/advanced-techniques.md#adapters">Adapters</a></li>
<li><a href="https://github.com/reimagined/resolve/blob/master/docs/preparing-to-production.md#configuring-adapters">Configuring Adapters</a></li>
</ul>
<p>The last step is to register the implemented aggregate in the application's configuration file. To do this, open the <strong>config.app.js</strong> file and specify the following settings in the <strong>aggregates</strong> configuration section:</p>
<p><strong>config.app.js</strong></p>
<pre><code class="hljs css language-js">...
aggregates: [
  {
    <span class="hljs-comment">// The aggregate name</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-comment">// A path to the file that defines the aggregate's command handlers</span>
    <span class="hljs-attr">commands</span>: <span class="hljs-string">'common/aggregates/shopping_list.commands.js'</span>,
  }
],
...
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="sending-commands-to-an-aggregate"></a><a href="#sending-commands-to-an-aggregate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending Commands to an Aggregate</h3>
<p>Now that your application can handle commands, you can use the reSolve framework's HTTP API to create shopping lists and populate them with items.</p>
<p>A request's body should have the <code>application/json</code> content type and contain a JSON representation of a command:</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"aggregateName"</span>: <span class="hljs-string">"ShoppingList"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"createShoppingList"</span>,
  <span class="hljs-attr">"aggregateId"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-attr">"payload"</span>: {
    <span class="hljs-attr">"text"</span>: <span class="hljs-string">"Item 1"</span>
  }
}
</code></pre>
<p>In addition to the aggregate name, command type and payload, this object specifies the aggregate's ID.</p>
<p>Run your application and send a POST request to the following URL:</p>
<pre><code class="hljs">http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">3000</span><span class="hljs-regexp">/api/</span>commands
</code></pre>
<p>You can use any REST client or <strong>curl</strong> to do this. For example, use the following console input to create a shopping list:</p>
<pre><code class="hljs css language-sh">curl -i http://localhost:3000/api/commands/ \
--header <span class="hljs-string">"Content-Type: application/json"</span> \
--data <span class="hljs-string">'
{
    "aggregateName": "ShoppingList",
    "aggregateId": "shopping-list-1",
    "type": "createShoppingList",
    "payload": {
        "name": "List 1"
    }
}
'</span>

X-Powered-By: Express
Content-Type: text/plain; charset=utf-8
Date: Wed, 21 Oct 2020 09:53:03 GMT
Connection: keep-alive
Content-Length: 169

{
  <span class="hljs-string">"aggregateId"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-string">"aggregateVersion"</span>: 1,
  <span class="hljs-string">"timestamp"</span>: 1603273983423,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"SHOPPING_LIST_CREATED"</span>,
  <span class="hljs-string">"payload"</span>: {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 1"</span>
  }
}
</code></pre>
<p>Use the console input shown below to add an item to the created shopping list:</p>
<pre><code class="hljs css language-sh">curl -i http://localhost:3000/api/commands/ \
--header <span class="hljs-string">"Content-Type: application/json"</span> \
--data <span class="hljs-string">'
{
    "aggregateName": "ShoppingList",
    "aggregateId": "shopping-list-1",
    "type": "createShoppingItem",
    "payload": {
        "id": "1",
        "text": "Milk"
    }
}
'</span>

X-Powered-By: Express
Content-Type: text/plain; charset=utf-8
Date: Wed, 21 Oct 2020 09:53:57 GMT
Connection: keep-alive
Content-Length: 182

{
  <span class="hljs-string">"aggregateId"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-string">"aggregateVersion"</span>: 2,
  <span class="hljs-string">"timestamp"</span>: 1603274037307,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>,
  <span class="hljs-string">"payload"</span>: {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"1"</span>,
    <span class="hljs-string">"text"</span>: <span class="hljs-string">"Milk"</span>
  }
}
</code></pre>
<p>You can now check the event store database to see the newly created events. To do this, use the <a href="https://sqlite.org/cli.html">Command Line Shell For SQLite</a> or any database management tool compatible with SQLite:</p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-sh">sqlite3 data/event-store.db
sqlite&gt; select * from events;
40|0|1603273983433|shopping-list-1|1|SHOPPING_LIST_CREATED|{<span class="hljs-string">"name"</span>:<span class="hljs-string">"List 1"</span>}
147|0|1603274037313|shopping-list-1|2|SHOPPING_ITEM_CREATED|{<span class="hljs-string">"id"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-string">"text"</span>:<span class="hljs-string">"Milk"</span>}
</code></pre>
<!-- prettier-ignore-end -->
<h3><a class="anchor" aria-hidden="true" id="input-validation"></a><a href="#input-validation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Input Validation</h3>
<p>Your application's write side currently does not validate input data. This results in the following issues:</p>
<ul>
<li>The command handlers do not check whether all required fields are in a command's payload.</li>
<li>It is possible to create more then one shopping list with the same aggregate ID.</li>
<li>You can create items in a nonexistent shopping list.</li>
</ul>
<p>To overcome the first issue, add checks at the beginning of each command handler:</p>
<p><strong>common/aggregates/shopping_list.commands.js</strong></p>
<pre><code class="hljs css language-js">createShoppingList: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!name) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The "name" field is required'</span>);
  ...
},
<span class="hljs-attr">createShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!id) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The "id" field is required'</span>)
  <span class="hljs-keyword">if</span> (!text) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The "text" field is required'</span>)
  ...
}
</code></pre>
<p>To overcome the second and third issues, you need to have an <strong>aggregate state</strong> object that keeps track of what shopping lists were already created. An aggregate <strong>projection</strong> assembles such an object from previously created events with the same aggregate ID. To add a projection to the ShoppingList aggregate, create a <strong>shopping_list.projection.js</strong> file in the <strong>common/aggregates</strong> folder and add the following code to this file:</p>
<p><strong>common/aggregates/shopping_list.projection.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// The Init function initializes a state object</span>
  <span class="hljs-attr">Init</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({}),
  <span class="hljs-comment">// A projection function updates the state based on events.</span>
  <span class="hljs-comment">// Each function is associated with a single event type.</span>
  <span class="hljs-comment">// A projection function receives the state and an event, and returns the updated state.</span>
  [SHOPPING_LIST_CREATED]: <span class="hljs-function">(<span class="hljs-params">state, { timestamp }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">createdAt</span>: timestamp, <span class="hljs-comment">// Add an event's timestamp to the state.</span>
  }),
}
</code></pre>
<p>Register the projection in the application's configuration file:</p>
<p><strong>config.app.js</strong></p>
<pre><code class="hljs css language-js">aggregates: [
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"ShoppingList"</span>,
    <span class="hljs-attr">commands</span>: <span class="hljs-string">"common/aggregates/shopping_list.commands.js"</span>,
    <span class="hljs-comment">// A path to the file that defines the projection</span>
    <span class="hljs-attr">projection</span>: <span class="hljs-string">"common/aggregates/shopping_list.projection.js"</span>
  }
],
</code></pre>
<p>You can use the state assembled by a projection on the write side to find out whether and when a shopping list was created for the current aggregate instance (an instance that the current aggregate ID identifies).</p>
<p><strong>common/aggregates/shopping_list.commands.js</strong></p>
<pre><code class="hljs css language-js">createShoppingList: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (state.createdAt) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Shopping list already exists'</span>);
  ...
},
<span class="hljs-attr">createShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!state || !state.createdAt) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Shopping list does not exist'</span>);
  }
  ...
}
</code></pre>
<p>You can send faulty commands to your aggregate to check whether the validation works as intended:</p>
<pre><code class="hljs css language-sh"><span class="hljs-comment"># Trying to create a shopping list without specifying the name</span>
$ curl -i http://localhost:3000/api/commands/ \
&gt; --header <span class="hljs-string">"Content-Type: application/json"</span> \
&gt; --data <span class="hljs-string">'
&gt; {
&gt;     "aggregateName": "ShoppingList",
&gt;     "aggregateId": "shopping-list-2",
&gt;     "type": "createShoppingList",
&gt;     "payload": { }
&gt; }
&gt; '</span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   164  100    31  100   133    142    610 --:--:-- --:--:-- --:--:--   655HTTP/1.1 500 Internal Server Error
X-Powered-By: Express
Date: Thu, 22 Nov 2018 11:14:10 GMT
Connection: keep-alive
Content-Length: 31

Command error: name is required
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-2---read-side---create-a-read-model-to-query-shopping-lists"></a><a href="#lesson-2---read-side---create-a-read-model-to-query-shopping-lists" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 2</strong> - Read side - Create a Read Model to Query Shopping Lists</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-2">[Get the Code for This Lesson]</a></p>
<p>Currently, your shopping list application has a write side that allows you to create shopping lists and add items to these lists. To obtain this data from the application, you need to implement the application's <strong><a href="/resolve/docs/app-structure#write-and-read-sides">read side</a></strong>.</p>
<h3><a class="anchor" aria-hidden="true" id="add-a-read-model"></a><a href="#add-a-read-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add a Read Model</h3>
<p>Add a <strong>ShoppingLists</strong> <strong><a href="/resolve/docs/read-side#read-models">Read Model</a></strong> to your application. A Read Model receives events and populates a persistent store based on event data. It uses the collected data to answer data queries.</p>
<p>Follow the steps below to implement a <strong>ShoppingLists</strong> Read Model.</p>
<p>First, define a Read Model <strong><a href="/resolve/docs/read-side#updating-a-read-model-via-projection-functions">projection</a></strong>. Create a <strong>shopping_list.projection.js</strong> file in the <strong>read-models</strong> folder and add the following code to this file:</p>
<p><strong>common/read-models/shopping_lists.projection.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// A Read Model projection describes logic used to collect data from incoming events.</span>
<span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// The 'Init' function initializes the store (defines tables and their fields).</span>
  <span class="hljs-attr">Init</span>: <span class="hljs-keyword">async</span> (store) =&gt; {
    <span class="hljs-keyword">await</span> store.defineTable(<span class="hljs-string">'ShoppingLists'</span>, {
      <span class="hljs-attr">indexes</span>: {
        <span class="hljs-attr">id</span>: <span class="hljs-string">'string'</span>,
      },
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">'createdAt'</span>, <span class="hljs-string">'name'</span>],
    })
  },
  <span class="hljs-comment">// A projection function runs once for every event of the specified type.</span>
  [SHOPPING_LIST_CREATED]: <span class="hljs-keyword">async</span> (
    store,
    { aggregateId, timestamp, <span class="hljs-attr">payload</span>: { name } }
  ) =&gt; {
    <span class="hljs-comment">// Build a data item based on the event data.</span>
    <span class="hljs-keyword">const</span> shoppingList = {
      <span class="hljs-attr">id</span>: aggregateId,
      name,
      <span class="hljs-attr">createdAt</span>: timestamp,
    }
    <span class="hljs-comment">// Save the data item to the store's table 'ShoppingLists' table.</span>
    <span class="hljs-keyword">await</span> store.insert(<span class="hljs-string">'ShoppingLists'</span>, shoppingList)
  },
}
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api"></a><a href="#used-api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#read-model-store-interface">store</a></li>
<li><a href="/resolve/docs/api-reference#definetable">store.defineTable</a></li>
<li><a href="/resolve/docs/api-reference#insert">store.insert</a></li>
</ul>
<p>The type of the physical store used to save data is defined by a Read Model connector:</p>
<p><strong>config.dev.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// The 'config.dev.js' file defines setting used only in the development environment.</span>
<span class="hljs-keyword">const</span> devConfig = {
  <span class="hljs-attr">readModelConnectors</span>: {
    <span class="hljs-comment">// This is the 'default' Read Model connector.</span>
    <span class="hljs-comment">// It connects a Read Model to a SQLite data.</span>
    <span class="hljs-attr">default</span>: {
      <span class="hljs-attr">module</span>: <span class="hljs-string">'@resolve-js/readmodel-lite'</span>,
      <span class="hljs-attr">options</span>: {
        <span class="hljs-attr">databaseFile</span>: <span class="hljs-string">'data/read-models.db'</span>,
      },
    },
    <span class="hljs-comment">// You can reconfigure the connector to use other databases:</span>
    <span class="hljs-comment">/*
      default: {
        module: '@resolve-js/readmodel-mysql',
        options: {
          host: 'localhost',
          port: 3306,
          user: 'customUser',
          password: 'customPassword',
          database: 'customDatabaseName'
        }
      }
    */</span>
  },
}
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-configuration-options"></a><a href="#used-configuration-options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used configuration options:</h5>
<ul>
<li><a href="/resolve/docs/application-configuration#readmodelconnectors">readModelConnectors</a></li>
</ul>
<p>Next, implement a query resolver to answer data queries based on the data from the store.</p>
<p><strong>common/read-models/shopping_lists.resolvers.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// The 'all' resolver returns all entries from the 'ShoppingLists' table.</span>
  <span class="hljs-attr">all</span>: <span class="hljs-keyword">async</span> (store) =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> store.find(<span class="hljs-string">'ShoppingLists'</span>, {}, <span class="hljs-literal">null</span>, { <span class="hljs-attr">createdAt</span>: <span class="hljs-number">1</span> })
  },
}
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-1"></a><a href="#used-api-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#find">store.find</a></li>
</ul>
<p>Register the created Read Model in the application configuration file:</p>
<p><strong>config.app.js</strong></p>
<pre><code class="hljs css language-js">...
readModels: [
  {
    <span class="hljs-comment">// The Read Model's name</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'ShoppingLists'</span>,
    <span class="hljs-comment">// A path to the file that defines the Read Model projection</span>
    <span class="hljs-attr">projection</span>: <span class="hljs-string">'common/read-models/shopping_lists.projection.js'</span>,
    <span class="hljs-comment">// A path to the file that defines the resolvers</span>
    <span class="hljs-attr">resolvers</span>: <span class="hljs-string">'common/read-models/shopping_lists.resolvers.js'</span>,
    <span class="hljs-comment">// The name of the connector used to store the state</span>
    <span class="hljs-attr">connectorName</span>: <span class="hljs-string">'default'</span>
  }
],
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="query-a-read-model"></a><a href="#query-a-read-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query a Read Model</h3>
<p>Use the reSolve HTTP API to query the ShoppingLists Read Model:</p>
<pre><code class="hljs css language-sh">$ curl -X POST \
-H <span class="hljs-string">"Content-Type: application/json"</span> \
-d <span class="hljs-string">"{}"</span> \
<span class="hljs-string">"http://localhost:3000/api/query/ShoppingLists/all"</span>

% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   186  100   184  100     2    844      9 --:--:-- --:--:-- --:--:--   906[
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-1"</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 1"</span>,
    <span class="hljs-string">"createdAt"</span>: 1543325125945
  },
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-2"</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 2"</span>,
    <span class="hljs-string">"createdAt"</span>: 1543325129138
  }
]
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-3---frontend---display-read-model-data-in-the-browser"></a><a href="#lesson-3---frontend---display-read-model-data-in-the-browser" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 3</strong> - Frontend - Display Read Model Data in the Browser</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-3">[Get the Code for This Lesson]</a></p>
<p>This lesson describes how to display a Read Model's data in the client browser. The code in this lesson uses the reSolve framework's <strong>@resolve-js/redux</strong> library to implement a frontend based on React with hooks.</p>
<p>Refer to the <a href="/resolve/docs/frontend">Frontend</a> article for information on other tools that you can use to implement a frontend.</p>
<h3><a class="anchor" aria-hidden="true" id="implement-the-client-application"></a><a href="#implement-the-client-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement the Client Application</h3>
<blockquote>
<p>The example project uses <strong>react-bootstrap</strong> to reduce the size of the markup To use this library, you should link the Bootstrap stylesheet file to the application's page. The example project's <strong>client/components/Header.js</strong> file demonstrates how to link static resources.</p>
</blockquote>
<p>First, implement a React component that renders a list of shopping list names. To do this, create a <strong>ShoppingLists.js</strong> file in the <strong>client/components</strong> subfolder and add the following code to this file:</p>
<p><strong>client/components/ShoppingLists.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { FormLabel, Table } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>

<span class="hljs-keyword">const</span> ShoppingLists = <span class="hljs-function">(<span class="hljs-params">{ lists }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormLabel</span>&gt;</span>My shopping lists<span class="hljs-tag">&lt;/<span class="hljs-name">FormLabel</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Table</span> <span class="hljs-attr">responsive</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>#<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Shopping List<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
          {lists.map(({ id, name }, index) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{index + 1}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Table</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingLists
</code></pre>
<p>Add a new component named <strong>MyLists</strong>. This component obtains shopping list data from reSolve and uses the <strong>ShoppingLists</strong> component to display this data. To obtain the data, use the <strong>@resolve-js/react-hooks</strong> library's <code>useQuery</code> hook:</p>
<p><strong>client/components/MyLists.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> React, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>
<span class="hljs-keyword">import</span> ShoppingLists <span class="hljs-keyword">from</span> <span class="hljs-string">'./ShoppingLists'</span>

<span class="hljs-keyword">const</span> MyLists = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> [lists, setLists] = useState({})

  <span class="hljs-comment">// The 'useQuery' hook is used to querry the 'ShoppingLists' Read Model's 'all' resolver.</span>
  <span class="hljs-comment">// The obtained data is stored in the component's state.</span>
  <span class="hljs-keyword">const</span> getLists = useQuery(
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'ShoppingLists'</span>, <span class="hljs-attr">resolver</span>: <span class="hljs-string">'all'</span>, <span class="hljs-attr">args</span>: {} },
    (error, result) =&gt; {
      <span class="hljs-comment">// Obtain the data on the component's mount.</span>
      setLists(result)
    }
  )
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    getLists()
  }, [])

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">maxWidth:</span> '<span class="hljs-attr">580px</span>',
        <span class="hljs-attr">margin:</span> '<span class="hljs-attr">0</span> <span class="hljs-attr">auto</span>',
        <span class="hljs-attr">paddingLeft:</span> '<span class="hljs-attr">10px</span>',
        <span class="hljs-attr">paddingRight:</span> '<span class="hljs-attr">10px</span>',
      }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingLists</span> <span class="hljs-attr">lists</span>=<span class="hljs-string">{lists</span> ? <span class="hljs-attr">lists.data</span> || [] <span class="hljs-attr">:</span> []} /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> MyLists
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-2"></a><a href="#used-api-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#usequery">useQuery</a></li>
</ul>
<p>Add the root component that defines the page's HEAD section and renders routes:</p>
<p><strong>client/components/App.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { renderRoutes } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-config'</span>
<span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">'./Header'</span>

<span class="hljs-keyword">const</span> App = <span class="hljs-function">(<span class="hljs-params">{ route, children }</span>) =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    {/*Define the HEAD section and register static resources.
       See the 'client/components/Header' file for implementation details.
    */}
    <span class="hljs-tag">&lt;<span class="hljs-name">Header</span>
      <span class="hljs-attr">title</span>=<span class="hljs-string">"ReSolve Shopping List Example"</span>
      <span class="hljs-attr">name</span>=<span class="hljs-string">"Shopping List"</span>
      <span class="hljs-attr">css</span>=<span class="hljs-string">{[</span>'/<span class="hljs-attr">bootstrap.min.css</span>']}
    /&gt;</span>
    {renderRoutes(route.routes)}
    {children}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App
</code></pre>
<p>The routes are defined as follows:</p>
<p><strong>client/routes.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/App'</span>
<span class="hljs-keyword">import</span> MyLists <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/MyLists'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
  {
    <span class="hljs-attr">component</span>: App,
    <span class="hljs-attr">routes</span>: [
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
        <span class="hljs-attr">component</span>: MyLists,
        <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span>,
      },
    ],
  },
]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="configure-the-entry-point"></a><a href="#configure-the-entry-point" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure the Entry Point</h3>
<p>A client entry point is a function that receives a <code>context</code> object as a parameter. Pass this object to the @resolve-js/react-hooks library to connect it to a reSolve backend. You can implement an entry point as shown below:</p>
<p><strong>client/index.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>
<span class="hljs-keyword">import</span> { ResolveContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>
<span class="hljs-keyword">import</span> { BrowserRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>
<span class="hljs-keyword">import</span> { renderRoutes } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-config'</span>

<span class="hljs-keyword">import</span> routes <span class="hljs-keyword">from</span> <span class="hljs-string">'./routes'</span>

<span class="hljs-comment">// The 'context' object contains metadata required by the '@resolve-js/react-hooks'</span>
<span class="hljs-comment">// library to connect to the reSolve backend.</span>
<span class="hljs-keyword">const</span> entryPoint = <span class="hljs-function">(<span class="hljs-params">context</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> appContainer = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>)
  <span class="hljs-built_in">document</span>.body.appendChild(appContainer)
  render(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ResolveContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{context}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">BrowserRouter</span>&gt;</span>{renderRoutes(routes)}<span class="hljs-tag">&lt;/<span class="hljs-name">BrowserRouter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ResolveContext.Provider</span>&gt;</span></span>,
    appContainer
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> entryPoint
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="register-the-entry-point"></a><a href="#register-the-entry-point" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Register the Entry Point</h3>
<p>Register the client entry point in the application's configuration file as shown below:</p>
<p><strong>config.app.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> appConfig = {
  ...
  clientEntries: [<span class="hljs-string">'client/index.js'</span>],
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> appConfig
</code></pre>
<p>Run your application to view the result:</p>
<p><img src="/resolve/docs/assets/tutorial/lesson3-result.png" alt="result"></p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-4---read-side---create-a-view-model-to-query-shopping-list-items"></a><a href="#lesson-4---read-side---create-a-view-model-to-query-shopping-list-items" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 4</strong> - Read Side - Create a View Model to Query Shopping List Items</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-4">[Get the Code for This Lesson]</a></p>
<p>This lesson describes how you can use a View Model to obtain shopping list items and display them as a list within the client browser.</p>
<p>A View Model is a reactive Read Model that is built on the fly for one or several aggregate IDs. A client can maintain a WebSocket connection with a resolve server to receive View Model data updates in real time.</p>
<p>The downside is that View Models do not have persistent state and should be rebuilt on every query, so they are better suited for small data samples.</p>
<h3><a class="anchor" aria-hidden="true" id="create-a-shopping-list-view-model"></a><a href="#create-a-shopping-list-view-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a Shopping List View Model</h3>
<p>Add a <strong>shopping_list.projection.js</strong> file in the <strong>common/view-models</strong> directory. Add the following code to this file:</p>
<p><strong>common/view-models/shopping_list.projection.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED, SHOPPING_ITEM_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-comment">// A View Model's projection is defined in a format that is isomorphic with a Redux reducer format.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// The 'Init' function initializes the View Model's state object.</span>
  <span class="hljs-attr">Init</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">id</span>: <span class="hljs-string">'id'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'unnamed'</span>,
    <span class="hljs-attr">list</span>: [],
  }),
  <span class="hljs-comment">// Below is a projection function. It runs on every event of the specified type, whose aggregate Id matches one of the Ids specified in the query.</span>
  <span class="hljs-comment">// A View Model projection takes the state and returns its updated version based on the event data.</span>
  <span class="hljs-comment">// When all events are applied, the built state is passed to the client in the response body.</span>
  [SHOPPING_LIST_CREATED]: <span class="hljs-function">(<span class="hljs-params">state, { aggregateId, payload: { name } }</span>) =&gt;</span> ({
    <span class="hljs-comment">// Assign the actual aggregate ID and name to the response.</span>
    <span class="hljs-attr">id</span>: aggregateId,
    name,
    <span class="hljs-attr">list</span>: [],
  }),
  [SHOPPING_ITEM_CREATED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-comment">// Add a shopping list item to a list within the state object.</span>
    <span class="hljs-attr">list</span>: [
      ...state.list,
      {
        id,
        text,
        <span class="hljs-attr">checked</span>: <span class="hljs-literal">false</span>,
      },
    ],
  }),
}
</code></pre>
<p>Register the View Model in the application configuration file:</p>
<p><strong>config.app.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> appConfig = {
  ...
  viewModels: [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'shoppingList'</span>,
      <span class="hljs-attr">projection</span>: <span class="hljs-string">'common/view-models/shopping_list.projection.js'</span>
    }
  ]
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> appConfig
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="query-a-view-model"></a><a href="#query-a-view-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query A View Model</h3>
<p>You can use the reSolve HTTP API to query a View Model:</p>
<pre><code class="hljs css language-bash">$  curl -i -g -X GET <span class="hljs-string">"http://localhost:3000/api/query/shoppingList/shopping-list-1"</span>
HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html; charset=utf-8
Content-Length: 50
ETag: W/<span class="hljs-string">"32-QoPdRfMTxfncCZnYSqRYIDifC/w"</span>
Date: Fri, 16 Nov 2018 12:10:58 GMT
Connection: keep-alive

{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 1"</span>,
  <span class="hljs-string">"list"</span>: [
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"1"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Milk"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"2"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Eggs"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"3"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Canned beans"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"4"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Paper towels"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    }
  ]
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="display-view-model-data-on-the-client"></a><a href="#display-view-model-data-on-the-client" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Display View Model Data on the Client</h3>
<p>Add the following React components to your client application to display shopping list items:</p>
<p><strong>client/components/ShoppingListItem.js:</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { ListGroupItem, FormCheck } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>

<span class="hljs-keyword">const</span> ShoppingListItem = <span class="hljs-function">(<span class="hljs-params">{ item: { id, text } }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ListGroupItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormCheck</span> <span class="hljs-attr">inline</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">{text}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ListGroupItem</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingListItem
</code></pre>
<p><strong>client/components/ShoppingList.js:</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { useViewModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>

<span class="hljs-keyword">import</span> { ListGroup, FormControl, FormGroup, FormLabel } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>

<span class="hljs-keyword">import</span> ShoppingListItem <span class="hljs-keyword">from</span> <span class="hljs-string">'./ShoppingListItem'</span>

<span class="hljs-comment">// The shopping list populated with items obtained from the ShoppingList View Model.</span>
<span class="hljs-keyword">const</span> ShoppingList = ({
  <span class="hljs-attr">match</span>: {
    <span class="hljs-attr">params</span>: { <span class="hljs-attr">id</span>: aggregateId },
  },
}) =&gt; {
  <span class="hljs-keyword">const</span> [shoppingList, setShoppingList] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">id</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">list</span>: [],
  })
  <span class="hljs-comment">// The UseViewModel hook connects the component to a View Model</span>
  <span class="hljs-comment">// and reactively updates the component's state when the View Model's</span>
  <span class="hljs-comment">// data is updated.</span>
  <span class="hljs-keyword">const</span> { connect, dispose } = useViewModel(
    <span class="hljs-string">'shoppingList'</span>, <span class="hljs-comment">// The View Model's name.</span>
    [aggregateId], <span class="hljs-comment">// The aggregate ID for which to query data.</span>
    setShoppingList <span class="hljs-comment">// A callback to call when new data is recieved.</span>
  )

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Connect to a View Model on component mount and disconnect on unmount.</span>
    connect()
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      dispose()
    }
  }, [])

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">maxWidth:</span> '<span class="hljs-attr">580px</span>',
        <span class="hljs-attr">margin:</span> '<span class="hljs-attr">0</span> <span class="hljs-attr">auto</span>',
        <span class="hljs-attr">paddingLeft:</span> '<span class="hljs-attr">10px</span>',
        <span class="hljs-attr">paddingRight:</span> '<span class="hljs-attr">10px</span>',
      }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormLabel</span>&gt;</span>Shopping list name<span class="hljs-tag">&lt;/<span class="hljs-name">FormLabel</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormGroup</span> <span class="hljs-attr">bssize</span>=<span class="hljs-string">"large"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormControl</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{shoppingList.name}</span> <span class="hljs-attr">readOnly</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">FormGroup</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ListGroup</span>&gt;</span>
        {shoppingList.list.map((item, idx) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingListItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{idx}</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span> /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ListGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingList
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-3"></a><a href="#used-api-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#useviewmodel">useViewModel</a></li>
</ul>
<p><img src="/resolve/docs/assets/tutorial/lesson4-list-items.png" alt="List Items"></p>
<h3><a class="anchor" aria-hidden="true" id="implement-navigation"></a><a href="#implement-navigation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement Navigation</h3>
<p>Modify the <strong>ShoppingLists</strong> component's layout as shown below to render links to shopping lists.</p>
<p><strong>client/components/ShoppingLists.js:</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">const</span> ShoppingLists = <span class="hljs-function">(<span class="hljs-params">{ lists }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      ...
      <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
        {lists.map(({ id, name }, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{index + 1}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">{</span>`/${<span class="hljs-attr">id</span>}`}&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
      ...
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p><img src="/resolve/docs/assets/tutorial/lesson4-navigation.png" alt="List Items"></p>
<p>Run the application and click a shopping list's name view the result. To test the View Model's reactiveness, keep the page opened and use the following console input to add a shopping list item:</p>
<pre><code class="hljs css language-bash">curl -i http://localhost:3000/api/commands/ \
--header <span class="hljs-string">"Content-Type: application/json"</span> \
--data <span class="hljs-string">'
{
    "aggregateName": "ShoppingList",
    "aggregateId": &lt;your_shopping_list`s_aggregate_id&gt;,
    "type": "createShoppingItem",
    "payload": {
        "id": "5",
        "text": "Bread"
    }
}
'</span>
</code></pre>
<p>The page is automatically updated to display the new item.</p>
<h2><a class="anchor" aria-hidden="true" id="lesson-5---enable-editing"></a><a href="#lesson-5---enable-editing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 5</strong> - Enable Editing</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-5">[Get the Code for This Lesson]</a></p>
<p>This lesson describes how to implement missing data editing functionality on the reSolve backend and enable data editing on the frontend.</p>
<h3><a class="anchor" aria-hidden="true" id="modify-the-backend"></a><a href="#modify-the-backend" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the Backend</h3>
<p>Currently your reSolve application can create shopping lists and their items. The application also requires the capability to toggle shopping list items as well as remove and items and entire lists.</p>
<p>To implement the missing functionality, you need to add data editing events, modify the ShoppingList aggregate to produce these events, and update read and view models to take these events into account.</p>
<h4><a class="anchor" aria-hidden="true" id="add-data-editing-events"></a><a href="#add-data-editing-events" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add Data Editing Events</h4>
<p>Define events related to data editing in the <strong>common/eventTypes.js</strong> file.</p>
<p><strong>common/eventTypes.js:</strong></p>
<pre><code class="hljs css language-js">...
export <span class="hljs-keyword">const</span> SHOPPING_LIST_REMOVED = <span class="hljs-string">'SHOPPING_LIST_REMOVED'</span> <span class="hljs-comment">// Indicates that a shopping list was removed.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_ITEM_TOGGLED = <span class="hljs-string">'SHOPPING_ITEM_TOGGLED'</span> <span class="hljs-comment">// Indicates that a list item was toggled.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_ITEM_REMOVED = <span class="hljs-string">'SHOPPING_ITEM_REMOVED'</span> <span class="hljs-comment">// Indicates that an item was removed.</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="modify-the-shoppinglist-aggregate"></a><a href="#modify-the-shoppinglist-aggregate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the ShoppingList Aggregate</h4>
<p>Add the following command handlers to the ShoppingList aggregate to validate the commands and produce the corresponding events:</p>
<p><strong>common/aggregates/shopping_lists.commands.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> {
    ...
    SHOPPING_LIST_REMOVED,
    SHOPPING_ITEM_TOGGLED,
    SHOPPING_ITEM_REMOVED,
  } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    ...
    removeShoppingList: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!state.createdAt) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Shopping List does not exist'</span>)
      }

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: SHOPPING_LIST_REMOVED,
      }
    },
    <span class="hljs-attr">toggleShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!state.createdAt) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Shopping List does not exist'</span>)
      }

      <span class="hljs-keyword">if</span> (!id) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The "id" field is required'</span>)
      }

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: SHOPPING_ITEM_TOGGLED,
        <span class="hljs-attr">payload</span>: { id },
      }
    },
    <span class="hljs-attr">removeShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!state.createdAt) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Shopping List does not exist'</span>)
      }

      <span class="hljs-keyword">if</span> (!id) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The "id" field is required'</span>)
      }

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: SHOPPING_ITEM_REMOVED,
        <span class="hljs-attr">payload</span>: { id },
      }
    },
  }
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="modify-the-shoppinglists-read-model"></a><a href="#modify-the-shoppinglists-read-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the ShoppingLists Read Model</h4>
<p>Define a projection function for the 'SHOPPING_LIST_REMOVED' event in the ShoppingLists Read Model's projection:</p>
<p><strong>common/read-models/shopping_lists.projection.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> {
    ...
    SHOPPING_LIST_REMOVED,
  } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    ...
    [SHOPPING_LIST_REMOVED]: <span class="hljs-keyword">async</span> (store, { aggregateId }) =&gt; {
      <span class="hljs-keyword">await</span> store.delete(<span class="hljs-string">'ShoppingLists'</span>, { <span class="hljs-attr">id</span>: aggregateId })
    },

  }
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="modify-the-shopping_list-view-model"></a><a href="#modify-the-shopping_list-view-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the shopping_list View Model</h4>
<p>In the ShoppingList View Model projection, add the following projection functions:</p>
<p><strong>common/view-models/shopping_list.projection.js</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> {
  ...
  SHOPPING_LIST_REMOVED,
  SHOPPING_ITEM_TOGGLED,
  SHOPPING_ITEM_REMOVED,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  ...
  [SHOPPING_LIST_REMOVED]: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">removed</span>: <span class="hljs-literal">true</span>,
  }),
  [SHOPPING_ITEM_TOGGLED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">list</span>: state.list.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
      item.id === id
        ? {
            ...item,
            <span class="hljs-attr">checked</span>: !item.checked,
          }
        : item
    ),
  }),
  [SHOPPING_ITEM_REMOVED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">list</span>: state.list.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id),
  }),
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="modify-the-frontend"></a><a href="#modify-the-frontend" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the Frontend</h3>
<p>Add a React component that creates shopping lists. The component renders a text input for a shopping list's name and an 'Add Shopping List' button.</p>
<p><strong>client/components/ShoppingListCreator.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { Button, Col, FormLabel, FormControl, Row } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>
<span class="hljs-keyword">import</span> { useCommand } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>
<span class="hljs-keyword">import</span> { v4 <span class="hljs-keyword">as</span> uuid } <span class="hljs-keyword">from</span> <span class="hljs-string">'uuid'</span>

<span class="hljs-keyword">const</span> ShoppingListCreator = <span class="hljs-function">(<span class="hljs-params">{ lists, onCreateSuccess }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [shoppingListName, setShoppingListName] = useState(<span class="hljs-string">''</span>)

  <span class="hljs-comment">// The useCommandHook allows you send commands to reSolve.</span>
  <span class="hljs-keyword">const</span> createShoppingListCommand = useCommand(
    {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'createShoppingList'</span>,
      <span class="hljs-attr">aggregateId</span>: uuid(),
      <span class="hljs-attr">aggregateName</span>: <span class="hljs-string">'ShoppingList'</span>,
      <span class="hljs-attr">payload</span>: {
        <span class="hljs-attr">name</span>: shoppingListName || <span class="hljs-string">`Shopping List <span class="hljs-subst">${lists.length + <span class="hljs-number">1</span>}</span>`</span>,
      },
    },
    (err, result) =&gt; {
      setShoppingListName(<span class="hljs-string">''</span>)
      <span class="hljs-comment">// A callback user to pass info about a newly created shopping list to the parrent component.</span>
      onCreateSuccess(err, result)
    }
  )

  <span class="hljs-keyword">const</span> updateShoppingListName = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setShoppingListName(event.target.value)
  }

  <span class="hljs-keyword">const</span> onShoppingListNamePressEnter = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (event.charCode === <span class="hljs-number">13</span>) {
      event.preventDefault()
      createShoppingListCommand()
    }
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormLabel</span>&gt;</span>Shopping list name<span class="hljs-tag">&lt;/<span class="hljs-name">FormLabel</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Row</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">md</span>=<span class="hljs-string">{8}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">FormControl</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{shoppingListName}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{updateShoppingListName}</span>
            <span class="hljs-attr">onKeyPress</span>=<span class="hljs-string">{onShoppingListNamePressEnter}</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">md</span>=<span class="hljs-string">{4}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">bstyle</span>=<span class="hljs-string">"success"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{createShoppingListCommand}</span>&gt;</span>
            Add Shopping List
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Row</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingListCreator
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-4"></a><a href="#used-api-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#usecommand">useCommand</a></li>
</ul>
<p><img src="/resolve/docs/assets/tutorial/lesson5-list-creator.png" alt="Shopping List Creator"></p>
<p>You can render this component within 'MyLists' as shown below:</p>
<p><strong>client/components/MyLists.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">const</span> MyLists = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  ...
  return (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      ...
      <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingListCreator</span>
        <span class="hljs-attr">lists</span>=<span class="hljs-string">{lists</span> ? <span class="hljs-attr">lists.data</span> || [] <span class="hljs-attr">:</span> []}
        <span class="hljs-attr">onCreateSuccess</span>=<span class="hljs-string">{(err,</span> <span class="hljs-attr">result</span>) =&gt;</span> { // Use a callback to handle the creation of new lists
          const nextLists = { ...lists }
          nextLists.data.push({
            name: result.payload.name,
            createdAt: result.timestamp,
            id: result.aggregateId,
          })
          setLists(nextLists)
        }}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p>The following component implements a <strong>Delete</strong> button for a shopping list:</p>
<p><strong>client/components/ShoppingListRemover.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { Button } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>
<span class="hljs-keyword">import</span> { useCommand } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>

<span class="hljs-keyword">const</span> ShoppingListRemover = <span class="hljs-function">(<span class="hljs-params">{ shoppingListId, onRemoveSuccess }</span>) =&gt;</span> {
  <span class="hljs-comment">// A command to remove the list</span>
  <span class="hljs-keyword">const</span> removeShoppingListCommand = useCommand(
    {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'removeShoppingList'</span>,
      <span class="hljs-attr">aggregateId</span>: shoppingListId,
      <span class="hljs-attr">aggregateName</span>: <span class="hljs-string">'ShoppingList'</span>,
    },
    onRemoveSuccess
  )

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{removeShoppingListCommand}</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingListRemover
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-5"></a><a href="#used-api-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#usecommand">useCommand</a></li>
</ul>
<p>Add this component to each item in the ShoppingLists component's layout:</p>
<p><strong>client/components/ShoppingLists.js</strong></p>
<pre><code class="hljs css language-jsx">const ShoppingLists = ({ lists, onRemoveSuccess }) =&gt; {
  return (
    &lt;div&gt;
        ...
        &lt;tbody&gt;
          {lists.map(({ id, name }, index) =&gt; (
            &lt;tr key={id}&gt;
              &lt;td&gt;{index + 1}&lt;/td&gt;
              &lt;td&gt;
                &lt;Link to={`/${id}`}&gt;{name}&lt;/Link&gt;
              &lt;/td&gt;
              &lt;td&gt;
                &lt;ShoppingListRemover
                  shoppingListId={id}
                  onRemoveSuccess={onRemoveSuccess}
                /&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
          ))}
        &lt;/tbody&gt;
      &lt;/Table&gt;
    &lt;/div&gt;
  )
}

export default ShoppingLists
</code></pre>
<p>Also add an <code>onRemoveSuccess</code> handler to MyLists:</p>
<p><strong>client/components/MyLists.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">const</span> MyLists = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  ...
  return (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{maxWidth:</span> "<span class="hljs-attr">580px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">0</span> <span class="hljs-attr">auto</span>", <span class="hljs-attr">paddingLeft:</span> "<span class="hljs-attr">10px</span>", <span class="hljs-attr">paddingRight:</span> "<span class="hljs-attr">10px</span>"}}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingLists</span>
        <span class="hljs-attr">lists</span>=<span class="hljs-string">{lists</span> ? <span class="hljs-attr">lists.data</span> || [] <span class="hljs-attr">:</span> []}
        <span class="hljs-attr">onRemoveSuccess</span>=<span class="hljs-string">{(err,</span> <span class="hljs-attr">result</span>) =&gt;</span> {
          setLists({
          ...lists,
          data: lists.data.filter((list) =&gt; list.id !== result.aggregateId),
         })
      }}
      /&gt;
      ...
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p><img src="/resolve/docs/assets/tutorial/lesson5-delete.png" alt="Delete Shopping List"></p>
<p>The code below demonstrates how to implement data editing for the ShoppingList component:</p>
<p><strong>client/components/ShoppingList.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { useCommandBuilder, useViewModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>

<span class="hljs-keyword">import</span> {
  Row,
  Col,
  ListGroup,
  Button,
  FormControl,
  FormGroup,
  FormLabel,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>

<span class="hljs-keyword">import</span> ShoppingListItem <span class="hljs-keyword">from</span> <span class="hljs-string">'./ShoppingListItem'</span>

<span class="hljs-keyword">const</span> ShoppingList = ({
  <span class="hljs-attr">match</span>: {
    <span class="hljs-attr">params</span>: { <span class="hljs-attr">id</span>: aggregateId },
  },
}) =&gt; {
  <span class="hljs-keyword">const</span> [shoppingList, setShoppingList] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">id</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">list</span>: [],
  })
  <span class="hljs-keyword">const</span> { connect, dispose } = useViewModel(
    <span class="hljs-string">'shoppingList'</span>,
    [aggregateId],
    setShoppingList
  )
  <span class="hljs-keyword">const</span> [itemText, setItemText] = useState(<span class="hljs-string">''</span>)
  <span class="hljs-keyword">const</span> clearItemText = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setItemText(<span class="hljs-string">''</span>)

  <span class="hljs-comment">// The useCommandBuilder hook creates a function that generates commands based on a parameter</span>
  <span class="hljs-keyword">const</span> createShoppingItem = useCommandBuilder(
    <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> ({
      <span class="hljs-attr">type</span>: <span class="hljs-string">'createShoppingItem'</span>,
      aggregateId,
      <span class="hljs-attr">aggregateName</span>: <span class="hljs-string">'ShoppingList'</span>,
      <span class="hljs-attr">payload</span>: {
        text,
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now().toString(),
      },
    }),
    clearItemText
  )

  <span class="hljs-keyword">const</span> updateItemText = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setItemText(event.target.value)
  }
  <span class="hljs-keyword">const</span> onItemTextPressEnter = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (event.charCode === <span class="hljs-number">13</span>) {
      event.preventDefault()
      createShoppingItem(itemText)
    }
  }

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    connect()
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      dispose()
    }
  }, [])

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">maxWidth:</span> '<span class="hljs-attr">580px</span>',
        <span class="hljs-attr">margin:</span> '<span class="hljs-attr">0</span> <span class="hljs-attr">auto</span>',
        <span class="hljs-attr">paddingLeft:</span> '<span class="hljs-attr">10px</span>',
        <span class="hljs-attr">paddingRight:</span> '<span class="hljs-attr">10px</span>',
      }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormLabel</span>&gt;</span>Shopping list name<span class="hljs-tag">&lt;/<span class="hljs-name">FormLabel</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormGroup</span> <span class="hljs-attr">bssize</span>=<span class="hljs-string">"large"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormControl</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{shoppingList.name}</span> <span class="hljs-attr">readOnly</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">FormGroup</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ListGroup</span>&gt;</span>
        {shoppingList.list.map((item, idx) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingListItem</span>
            <span class="hljs-attr">shoppingListId</span>=<span class="hljs-string">{aggregateId}</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{idx}</span>
            <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
          /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ListGroup</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormLabel</span>&gt;</span>Item name<span class="hljs-tag">&lt;/<span class="hljs-name">FormLabel</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Row</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">md</span>=<span class="hljs-string">{8}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">FormControl</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{itemText}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{updateItemText}</span>
            <span class="hljs-attr">onKeyPress</span>=<span class="hljs-string">{onItemTextPressEnter}</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">md</span>=<span class="hljs-string">{4}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
            <span class="hljs-attr">bsstyle</span>=<span class="hljs-string">"success"</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> createShoppingItem(itemText)}
          &gt;
            Add Item
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Row</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingList
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-6"></a><a href="#used-api-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#usecommandbuilder">useCommandBuilder</a></li>
<li><a href="/resolve/docs/api-reference#useviewmodel">useViewModel</a></li>
</ul>
<p>Modify the ShoppingListItem component to support item checking and deletion.</p>
<p><strong>client/components/ShoppingListItem.js</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { ListGroupItem, FormCheck, Button } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>
<span class="hljs-keyword">import</span> { useCommand } <span class="hljs-keyword">from</span> <span class="hljs-string">'@resolve-js/react-hooks'</span>

<span class="hljs-keyword">const</span> ShoppingListItem = <span class="hljs-function">(<span class="hljs-params">{ shoppingListId, item: { id, checked, text } }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> toggleItem = useCommand({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'toggleShoppingItem'</span>,
    <span class="hljs-attr">aggregateId</span>: shoppingListId,
    <span class="hljs-attr">aggregateName</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">payload</span>: {
      id,
    },
  })
  <span class="hljs-keyword">const</span> removeItem = useCommand({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'removeShoppingItem'</span>,
    <span class="hljs-attr">aggregateId</span>: shoppingListId,
    <span class="hljs-attr">aggregateName</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">payload</span>: {
      id,
    },
  })
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ListGroupItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormCheck</span>
        <span class="hljs-attr">inline</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">{text}</span>
        <span class="hljs-attr">checked</span>=<span class="hljs-string">{checked}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{toggleItem}</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"float-right"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{removeItem}</span>&gt;</span>
        Delete
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ListGroupItem</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ShoppingListItem
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="used-api-7"></a><a href="#used-api-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Used API:</h5>
<ul>
<li><a href="/resolve/docs/api-reference#usecommand">useCommand</a></li>
</ul>
<p><img src="/resolve/docs/assets/tutorial/lesson5-check-item.png" alt="Check List Item"></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/resolve/docs/introduction"><span class="arrow-prev">← </span><span>Introduction</span></a><a class="docs-next button" href="/resolve/docs/write-side"><span>Write Side</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#preparation---create-a-new-resolve-application"><strong>Preparation</strong> - Create a New reSolve Application</a></li><li><a href="#lesson-1---write-side---add-shopping-lists"><strong>Lesson 1</strong> - Write side - Add Shopping Lists</a><ul class="toc-headings"><li><a href="#create-an-aggregate">Create an Aggregate</a></li><li><a href="#sending-commands-to-an-aggregate">Sending Commands to an Aggregate</a></li><li><a href="#input-validation">Input Validation</a></li></ul></li><li><a href="#lesson-2---read-side---create-a-read-model-to-query-shopping-lists"><strong>Lesson 2</strong> - Read side - Create a Read Model to Query Shopping Lists</a><ul class="toc-headings"><li><a href="#add-a-read-model">Add a Read Model</a></li><li><a href="#query-a-read-model">Query a Read Model</a></li></ul></li><li><a href="#lesson-3---frontend---display-read-model-data-in-the-browser"><strong>Lesson 3</strong> - Frontend - Display Read Model Data in the Browser</a><ul class="toc-headings"><li><a href="#implement-the-client-application">Implement the Client Application</a></li><li><a href="#configure-the-entry-point">Configure the Entry Point</a></li><li><a href="#register-the-entry-point">Register the Entry Point</a></li></ul></li><li><a href="#lesson-4---read-side---create-a-view-model-to-query-shopping-list-items"><strong>Lesson 4</strong> - Read Side - Create a View Model to Query Shopping List Items</a><ul class="toc-headings"><li><a href="#create-a-shopping-list-view-model">Create a Shopping List View Model</a></li><li><a href="#query-a-view-model">Query A View Model</a></li><li><a href="#display-view-model-data-on-the-client">Display View Model Data on the Client</a></li><li><a href="#implement-navigation">Implement Navigation</a></li></ul></li><li><a href="#lesson-5---enable-editing"><strong>Lesson 5</strong> - Enable Editing</a><ul class="toc-headings"><li><a href="#modify-the-backend">Modify the Backend</a></li><li><a href="#modify-the-frontend">Modify the Frontend</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/resolve/" class="nav-home"><img src="/resolve/img/resolve.svg" alt="reSolve" width="66" height="58"/></a><div><h5>Docs</h5><a href="/resolve/docs/">Documentation Index</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/resolvejs" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/resolvejs" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.facebook.com/resolvejs/" target="_blank" rel="noreferrer noopener">Facebook</a></div><div><h5>More</h5><a href="https://github.com/reimagined/resolve">GitHub</a><a class="github-button" href="https://github.com/reimagined/resolve" data-icon="octicon-star" data-count-href="/reimagined/resolve/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2021 Developer Express, Inc</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2acd75b7a94d568aa418a4f02bd811cc',
                indexName: 'reimagined_resolve',
                inputSelector: '#search_input_react'
              });
            </script></body></html>